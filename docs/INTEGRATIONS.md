# üîó Integration Examples

## üåê Language Selection / Ë®ÄË™ûÈÅ∏Êäû

**English** (you are here) | [Êó•Êú¨Ë™û](INTEGRATIONS-ja.md)

> Real-world examples for integrating Function Indexer into your development workflow

## üöÄ CI/CD Integrations

### GitHub Actions

<details>
<summary><strong>üìä Code Quality Check on Pull Requests</strong></summary>

Create `.github/workflows/code-quality.yml`:

```yaml
name: Code Quality Analysis

on:
  pull_request:
    branches: [main, develop]
  push:
    branches: [main]

jobs:
  quality-check:
    runs-on: ubuntu-latest
    name: Analyze Code Quality
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Install Function Indexer
        run: npm install -g function-indexer
        
      - name: Generate function index
        run: function-indexer
        
      - name: Analyze code metrics
        id: metrics
        run: |
          echo "## üìä Code Quality Report" >> $GITHUB_STEP_SUMMARY
          function-indexer metrics >> $GITHUB_STEP_SUMMARY
          
          # Check for high complexity functions
          if function-indexer metrics | grep -q "High Risk"; then
            echo "high_complexity=true" >> $GITHUB_OUTPUT
            echo "‚ö†Ô∏è **High complexity functions detected!**" >> $GITHUB_STEP_SUMMARY
            function-indexer metrics --details >> $GITHUB_STEP_SUMMARY
          else
            echo "high_complexity=false" >> $GITHUB_OUTPUT
            echo "‚úÖ **All functions within complexity thresholds**" >> $GITHUB_STEP_SUMMARY
          fi
          
      - name: Comment on PR
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            const { execSync } = require('child_process');
            const metrics = execSync('function-indexer metrics', { encoding: 'utf8' });
            
            const comment = `## üìä Function Indexer Report
            
            ${metrics}
            
            <details>
            <summary>üîç Function Search Available</summary>
            
            You can search through the analyzed functions:
            \`\`\`bash
            function-indexer search "your query"
            \`\`\`
            
            </details>
            
            *Generated by Function Indexer*`;
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
            
      - name: Fail if high complexity
        if: steps.metrics.outputs.high_complexity == 'true'
        run: |
          echo "::error::High complexity functions detected. Consider refactoring before merging."
          exit 1
```

</details>

<details>
<summary><strong>üìà Complexity Trend Tracking</strong></summary>

Track complexity trends over time:

```yaml
name: Complexity Trend Analysis

on:
  push:
    branches: [main]

jobs:
  track-complexity:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full history for trend analysis
          
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: Install Function Indexer
        run: npm install -g function-indexer
        
      - name: Generate metrics report
        run: |
          function-indexer
          function-indexer metrics --details > complexity-report.txt
          
      - name: Upload complexity report
        uses: actions/upload-artifact@v4
        with:
          name: complexity-report-${{ github.sha }}
          path: complexity-report.txt
          
      - name: Store metrics in repository
        run: |
          mkdir -p .github/metrics
          echo "$(date): $(function-indexer metrics | grep 'Total Functions')" >> .github/metrics/history.log
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add .github/metrics/history.log
          git commit -m "Update complexity metrics [skip ci]" || exit 0
          git push
```

</details>

### GitLab CI

<details>
<summary><strong>ü¶ä GitLab Pipeline Integration</strong></summary>

Add to `.gitlab-ci.yml`:

```yaml
stages:
  - analyze
  - quality-gate

variables:
  NODE_VERSION: "18"

function-indexer:analyze:
  stage: analyze
  image: node:${NODE_VERSION}
  before_script:
    - npm install -g function-indexer
  script:
    - function-indexer
    - function-indexer metrics > metrics-report.txt
    - function-indexer metrics --details > detailed-metrics.txt
  artifacts:
    reports:
      junit: test-results.xml
    paths:
      - .function-indexer/
      - metrics-report.txt
      - detailed-metrics.txt
    expire_in: 1 week
  only:
    - merge_requests
    - main
    - develop

quality-gate:
  stage: quality-gate
  image: node:${NODE_VERSION}
  dependencies:
    - function-indexer:analyze
  script:
    - |
      if grep -q "High Risk" metrics-report.txt; then
        echo "‚ùå Quality gate failed: High complexity functions detected"
        cat detailed-metrics.txt
        exit 1
      else
        echo "‚úÖ Quality gate passed: All functions within thresholds"
      fi
  only:
    - merge_requests
    - main
```

</details>

### Azure DevOps

<details>
<summary><strong>üî∑ Azure Pipelines</strong></summary>

Create `azure-pipelines.yml`:

```yaml
trigger:
  - main
  - develop

pr:
  - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  nodeVersion: '18.x'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: $(nodeVersion)
  displayName: 'Install Node.js'

- script: |
    npm install -g function-indexer
  displayName: 'Install Function Indexer'

- script: |
    function-indexer
    function-indexer metrics > $(Agent.TempDirectory)/metrics.txt
  displayName: 'Analyze Code Quality'

- script: |
    echo "##vso[task.uploadsummary]$(Agent.TempDirectory)/metrics.txt"
    
    if grep -q "High Risk" $(Agent.TempDirectory)/metrics.txt; then
      echo "##vso[task.logissue type=warning]High complexity functions detected"
      function-indexer metrics --details
    fi
  displayName: 'Report Results'

- task: PublishTestResults@2
  inputs:
    testResultsFiles: '$(Agent.TempDirectory)/metrics.txt'
    testRunTitle: 'Function Indexer Metrics'
  condition: always()
```

</details>

## ü™ù Git Hooks

### Pre-commit Hooks

<details>
<summary><strong>üîß Husky + Function Indexer</strong></summary>

1. **Install Husky:**
   ```bash
   npm install --save-dev husky
   npx husky install
   ```

2. **Create pre-commit hook:**
   ```bash
   npx husky add .husky/pre-commit "npm run pre-commit"
   ```

3. **Add to package.json:**
   ```json
   {
     "scripts": {
       "pre-commit": "function-indexer && npm run check-complexity"
       "check-complexity": "function-indexer metrics | grep -q 'High Risk' && echo '‚ö†Ô∏è High complexity detected' || echo '‚úÖ Complexity OK'"
     }
   }
   ```

4. **Advanced pre-commit script:**
   ```bash
   #!/bin/sh
   . "$(dirname "$0")/_/husky.sh"

   echo "üîç Analyzing code with Function Indexer..."
   
   # Update function index
   function-indexer
   
   # Check for high complexity in changed files
   changed_files=$(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(ts|tsx|js|jsx)$')
   
   if [ -n "$changed_files" ]; then
     echo "üìä Checking complexity of changed files..."
     
     # Check if any changed files have high complexity
     for file in $changed_files; do
       if function-indexer search "$(basename "$file" .ts)" --limit 1 | grep -q "High complexity"; then
         echo "‚ö†Ô∏è High complexity detected in $file"
         echo "Consider refactoring before committing."
         echo "Run 'function-indexer metrics --details' for more information."
         exit 1
       fi
     done
     
     echo "‚úÖ All changed files pass complexity checks"
   fi
   
   # Update index if it changed
   if git diff --cached --quiet .function-indexer/; then
     echo "üìù Adding updated function index to commit"
     git add .function-indexer/
   fi
   ```

</details>

### Pre-push Hooks

<details>
<summary><strong>üöÄ Pre-push Quality Check</strong></summary>

Create `.husky/pre-push`:

```bash
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üöÄ Running pre-push quality checks..."

# Full analysis before push
function-indexer

# Generate comprehensive report
function-indexer metrics > /tmp/quality-report.txt

# Check quality thresholds
high_risk=$(grep "High Risk:" /tmp/quality-report.txt | grep -o "[0-9]\+")
total_functions=$(grep "Total Functions:" /tmp/quality-report.txt | grep -o "[0-9]\+")

if [ "$high_risk" -gt 0 ]; then
  echo "‚ö†Ô∏è Quality gate check:"
  echo "   High risk functions: $high_risk"
  echo "   Total functions: $total_functions"
  echo "   Risk ratio: $(echo "scale=2; $high_risk / $total_functions * 100" | bc)%"
  
  if [ "$(echo "$high_risk / $total_functions > 0.1" | bc)" -eq 1 ]; then
    echo "‚ùå Quality gate failed: Too many high-risk functions (>10%)"
    echo "Run 'function-indexer metrics --details' to see specific issues"
    exit 1
  fi
fi

echo "‚úÖ Quality gate passed"
```

</details>

## üîÑ Development Workflow

### VS Code Integration

<details>
<summary><strong>üìù VS Code Tasks</strong></summary>

Create `.vscode/tasks.json`:

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Function Indexer: Analyze",
      "type": "shell",
      "command": "function-indexer",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Function Indexer: Metrics",
      "type": "shell",
      "command": "function-indexer metrics",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Function Indexer: Search",
      "type": "shell",
      "command": "function-indexer search",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    }
  ]
}
```

Create `.vscode/launch.json` for debugging:

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Function Indexer",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/node_modules/.bin/function-indexer",
      "args": ["--verbose"],
      "console": "integratedTerminal",
      "cwd": "${workspaceFolder}"
    }
  ]
}
```

</details>

### Package.json Scripts

<details>
<summary><strong>üì¶ NPM Scripts Integration</strong></summary>

Add to your `package.json`:

```json
{
  "scripts": {
    "analyze": "function-indexer",
    "analyze:verbose": "function-indexer --verbose",
    "metrics": "function-indexer metrics",
    "metrics:details": "function-indexer metrics --details",
    "search": "function-indexer search",
    "quality:check": "function-indexer metrics | grep -q 'High Risk' && exit 1 || echo '‚úÖ Quality OK'",
    "quality:report": "function-indexer metrics > quality-report.txt && cat quality-report.txt",
    "pre-commit": "npm run analyze && npm run quality:check",
    "pre-push": "npm run analyze && npm run quality:report"
  }
}
```

Usage:
```bash
npm run analyze
npm run metrics
npm run search "authentication"
npm run quality:check
```

</details>

### Makefile Integration

<details>
<summary><strong>üî® Makefile Commands</strong></summary>

Create `Makefile`:

```makefile
.PHONY: analyze metrics search quality setup help

# Default target
help: ## Show this help message
	@echo "Function Indexer Make Commands:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'

setup: ## Install Function Indexer
	npm install -g function-indexer

analyze: ## Run function analysis
	@echo "üîç Analyzing codebase..."
	function-indexer

metrics: ## Show code quality metrics
	@echo "üìä Code Quality Metrics:"
	function-indexer metrics

metrics-details: ## Show detailed metrics
	@echo "üìä Detailed Code Quality Metrics:"
	function-indexer metrics --details

search: ## Search functions (usage: make search QUERY="auth")
	@echo "üîç Searching for: $(QUERY)"
	function-indexer search "$(QUERY)"

quality-check: ## Check quality thresholds
	@echo "üéØ Quality Check:"
	@function-indexer metrics | grep -q "High Risk" && \
		(echo "‚ùå Quality check failed" && exit 1) || \
		echo "‚úÖ Quality check passed"

quality-report: ## Generate quality report
	@echo "üìÑ Generating quality report..."
	function-indexer metrics > quality-report.txt
	@cat quality-report.txt

ci-check: analyze quality-check ## Run CI quality checks

pre-commit: analyze quality-check ## Pre-commit checks

clean: ## Clean Function Indexer data
	rm -rf .function-indexer
	rm -f quality-report.txt
```

Usage:
```bash
make analyze
make metrics
make search QUERY="authentication"
make quality-check
```

</details>

## üìä Monitoring & Reporting

### Quality Dashboard

<details>
<summary><strong>üìà Automated Quality Reports</strong></summary>

Create a script to generate regular quality reports:

```bash
#!/bin/bash
# quality-dashboard.sh

DATE=$(date +"%Y-%m-%d")
REPORT_DIR="quality-reports"
REPORT_FILE="$REPORT_DIR/quality-$DATE.md"

mkdir -p "$REPORT_DIR"

cat > "$REPORT_FILE" << EOF
# Code Quality Report - $DATE

## Summary
$(function-indexer metrics)

## Detailed Analysis
$(function-indexer metrics --details)

## Top Complex Functions
$(function-indexer search "function" --limit 10 | grep "High complexity")

## Search Examples
\`\`\`bash
# Search for authentication functions
function-indexer search "auth"

# Search for API endpoints
function-indexer search "api route"

# Search for database operations
function-indexer search "database query"
\`\`\`

---
*Generated on $DATE*
EOF

echo "üìä Quality report generated: $REPORT_FILE"

# Optional: Send to team chat (Slack, Discord, etc.)
if [ -n "$SLACK_WEBHOOK" ]; then
  curl -X POST -H 'Content-type: application/json' \
    --data "{\"text\":\"üìä Daily Code Quality Report: $DATE\n\`\`\`$(function-indexer metrics)\`\`\`\"}" \
    "$SLACK_WEBHOOK"
fi
```

Add to crontab for daily reports:
```bash
# Run daily at 9 AM
0 9 * * * /path/to/quality-dashboard.sh
```

</details>

### Integration with Code Review

<details>
<summary><strong>üîç Code Review Assistant</strong></summary>

Create a script for reviewers:

```bash
#!/bin/bash
# review-helper.sh

echo "üîç Code Review Assistant"
echo "======================="

# Get changed files in current branch
changed_files=$(git diff main...HEAD --name-only | grep -E '\.(ts|tsx|js|jsx)$')

if [ -z "$changed_files" ]; then
  echo "No TypeScript/JavaScript files changed."
  exit 0
fi

echo "üìÅ Changed files:"
echo "$changed_files"
echo ""

# Analyze current state
echo "üìä Current Quality Metrics:"
function-indexer metrics
echo ""

# Check specific changed files
echo "üîç Analysis of changed files:"
for file in $changed_files; do
  if [ -f "$file" ]; then
    basename_file=$(basename "$file" | sed 's/\.[^.]*$//')
    echo "üìÑ $file:"
    function-indexer search "$basename_file" --limit 3
    echo ""
  fi
done

# Provide suggestions
echo "üí° Review Suggestions:"
echo "‚Ä¢ Check for functions with high complexity"
echo "‚Ä¢ Look for opportunities to extract smaller functions"
echo "‚Ä¢ Verify new functions follow naming conventions"
echo "‚Ä¢ Consider adding unit tests for complex functions"
```

Usage during code review:
```bash
git checkout feature/new-auth
./review-helper.sh
```

</details>

## üöÄ Advanced Integrations

### Docker Integration

<details>
<summary><strong>üê≥ Containerized Analysis</strong></summary>

Create `Dockerfile.analysis`:

```dockerfile
FROM node:18-alpine

# Install Function Indexer
RUN npm install -g function-indexer

# Set working directory
WORKDIR /app

# Copy source code
COPY . .

# Run analysis
CMD ["sh", "-c", "function-indexer && function-indexer metrics"]
```

Usage:
```bash
# Build analysis container
docker build -f Dockerfile.analysis -t my-app-analysis .

# Run analysis
docker run --rm -v $(pwd):/app my-app-analysis

# Or as part of docker-compose
```

Add to `docker-compose.yml`:
```yaml
version: '3.8'
services:
  app:
    build: .
    # ... your app config
    
  code-analysis:
    build:
      context: .
      dockerfile: Dockerfile.analysis
    volumes:
      - .:/app
    command: |
      sh -c "
        function-indexer
        function-indexer metrics > /tmp/metrics.txt
        cat /tmp/metrics.txt
      "
```

</details>

### Slack/Discord Notifications

<details>
<summary><strong>üí¨ Team Notifications</strong></summary>

Create a notification script:

```bash
#!/bin/bash
# notify-team.sh

WEBHOOK_URL="YOUR_SLACK_WEBHOOK_URL"
PROJECT_NAME="My Awesome Project"

# Generate metrics
metrics=$(function-indexer metrics)
high_risk=$(echo "$metrics" | grep "High Risk:" | grep -o "[0-9]\+")

# Determine message color
if [ "$high_risk" -gt 0 ]; then
  color="warning"
  emoji="‚ö†Ô∏è"
else
  color="good"
  emoji="‚úÖ"
fi

# Send to Slack
curl -X POST -H 'Content-type: application/json' \
  --data "{
    \"attachments\": [
      {
        \"color\": \"$color\",
        \"title\": \"$emoji Code Quality Report - $PROJECT_NAME\",
        \"text\": \"\`\`\`$metrics\`\`\`\",
        \"footer\": \"Function Indexer\",
        \"ts\": $(date +%s)
      }
    ]
  }" \
  "$WEBHOOK_URL"
```

For Discord:
```bash
#!/bin/bash
# discord-notify.sh

DISCORD_WEBHOOK="YOUR_DISCORD_WEBHOOK"
metrics=$(function-indexer metrics)

curl -H "Content-Type: application/json" \
  -d "{
    \"embeds\": [
      {
        \"title\": \"üìä Code Quality Report\",
        \"description\": \"\`\`\`$metrics\`\`\`\",
        \"color\": 5814783,
        \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%S.000Z)\"
      }
    ]
  }" \
  "$DISCORD_WEBHOOK"
```

</details>

---

## üéØ Best Practices

1. **Start Simple**: Begin with basic CI integration, then add complexity
2. **Gradual Rollout**: Introduce quality gates gradually to avoid disrupting workflow
3. **Team Training**: Ensure team understands metrics and thresholds
4. **Regular Reviews**: Periodically review and adjust quality thresholds
5. **Documentation**: Keep integration docs updated as workflows evolve

## üìû Need Help?

- üìñ Check our [Troubleshooting Guide](TROUBLESHOOTING.md)
- üí¨ Join [GitHub Discussions](https://github.com/akiramei/function-indexer/discussions)
- üêõ Report integration issues on [GitHub](https://github.com/akiramei/function-indexer/issues)

---

**üöÄ Ready to integrate?** Pick the workflow that matches your team's setup and start improving code quality today!